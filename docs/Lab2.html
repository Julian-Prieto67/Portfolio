<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html class="no-js">
    <head>
        <!-- Basic Page Needs
        ================================================== -->
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <link rel="icon" href="favicon.ico">
        <title>Julian Prieto | Lab 2</title>
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="author" content="">
        <!-- Mobile Specific Metas
        ================================================== -->
        <meta name="format-detection" content="telephone=no">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        
        <!-- Template CSS Files
        ================================================== -->
        <!-- Twitter Bootstrs CSS -->
        <link rel="stylesheet" href="plugins/bootstrap/bootstrap.min.css">
        <!-- Ionicons Fonts Css -->
        <link rel="stylesheet" href="plugins/ionicons/ionicons.min.css">
        <!-- animate css -->
        <link rel="stylesheet" href="plugins/animate-css/animate.css">
        <!-- Hero area slider css-->
        <link rel="stylesheet" href="plugins/slider/slider.css">
        <!-- slick slider -->
        <link rel="stylesheet" href="plugins/slick/slick.css">
        <!-- Fancybox -->
        <link rel="stylesheet" href="plugins/facncybox/jquery.fancybox.css">
        <!-- hover -->
        <link rel="stylesheet" href="plugins/hover/hover-min.css">
        <!-- template main css file -->
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body> <!--
        ==================================================
        Header Section Start
        ================================================== -->
        <section class="top-bar animated-header">
          <div class="container">
              <div class="row">
                  <div class="col-lg-12">
                      <nav class="navbar navbar-expand-lg navbar-light bg-light">
                          <a class="navbar-brand" href="index.html">
                              <!-- <img class="logo" src="./images/logo.jpg" alt="logo"> -->
                          </a>
                          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                              aria-expanded="false" aria-label="Toggle navigation">
                              <span class="navbar-toggler-icon"></span>
                          </button>
      
                          <div class="collapse navbar-collapse" id="navbarSupportedContent">
                              <ul class="navbar-nav ml-auto">
                                  <li class="nav-item">
                                      <a class="nav-link" href="index.html">Home
                                          <span class="sr-only">(current)</span>
                                      </a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" href="about.html">About</a>
                                  </li>
                              </ul>
                          </div>
                      </nav>
                  </div>
              </div>
          </div>
      </section>
<!--
==================================================
Global Page Section Start
================================================== -->
<section class="global-page-header">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="block">
          <h2>Lab 2: Setting Up Bluetooth</h2>
          <div class="portfolio-meta">
            <span>February 1st, 2023</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!--/#Page header-->

<!-- work details part start -->
<section class="work-single">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div style="display: flex; justify-content: center;"class="work-single-image">
          <!-- Work Single Image -->
          <img style="height: 330px"src="images/bluetooth.png" alt="work-single-image">
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <!-- work single Content -->
        <div class="work-single-content">
            <h2 style=" text-align: center">
            INTRODUCTION 
          </h2>
          <p>In order to communicate with the Artemis board wirelessly later on for debugging or data collection,
            I needed to establish bluetooth communication. <a href="https://cei-lab.github.io/ECE4960-2022/Lab2.html">Lab 2's</a> goal
            was to use jupyter lab and Arduino together to establish communications between the Artemis and my computer. By completing each lab task,
            I showed that I could use bluetooth to send real-time sensor data and error reports. 
          </p>
          <h2 style="text-align: center">SETUP</h2> 
          <p>
            Prior to coming into lab, I needed to prepare the software that would be used. Because I already had python3, all I had to do was install pip by copying and 
            pasting the following into command prompt:
          <p>
            <code>
              python3 -m pip install --user virtualenv
            </code>
          <p>
           In order to create the new virtual environment I then typed:
          </p>
          <code>
            python3 -m venv FastRobots_ble
          </code>
          <p>
            This created a new virtual environment that I could use to run python scripts after activating it by typing: 
          </p>
          <code>
            >.\FastRobots_ble\Scripts\activate <br>
            >jupyter lab
          </code>
          <p>
            After that, I installed the codebase that was required and the ArduinoBLE library. The codebase had all the python sketches I needed
            in order to understand how to connect with the Artemis. The config file connection.yaml would hold the
            important identifiers like UUID and MAC addresses that would be used by the class ArtemisBLEController to send data and
            execute commands on the arduino that I would implement. These commands would be sent to the Artemis along with a string as data.
            The board could then do whatever with the information and send back another string.  
          </p>
          <img src="./images/lab2/advertiseMAC.PNG">
          <h2 style="text-align: center">CONFIGURATION</h2> 
          <p>
            By burning the ble_arduino.ino script into the microcontroller I was able to find my MAC address
            and get started. I decided to create a Unique Universal Identifier (UUID) to ensure I was the only one that could connect to it.
            To do this I opened a terminal in jupyter lab and typed: 
          </p>
          <code>
            from uuid import uuid4 <br>
            uuid4()
          </code>
          <p>
            I then replaced all given UUID's with the one I'd just generated.
          </p>
          <img src="./images/lab2/advertiseUUID.PNG">
          <p>
            To first make sure everything was set up correctly, I ran each cell in the demo.ipynb file in the codebase.
            Here is a quick video showing that all went well and I could continue with the presented tasks.
          </p>
          <iframe width="320" height="560" src="https://www.youtube.com/embed/t2D7ntfHmlE" title="Fast Robots Lab 2: Configuring Bluetooth" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>
        <h2 style="text-align: center">ECHO</h2> 
          <p>
            In order to communicate, the Artemis board must be able to send and modify strings. In order to accomplish this, 
            I created a new command called ECHO. This command simply appended an incoming string with a smiley face to show its approval. 
            <br>" :D"<br> 
            Below you can see the results. 
          </p>
          <img src="./images/lab2/ncie.PNG">
          <h2 style="text-align: center">GET_TIME_MILLIS</h2> 
          <p>
            The next test was to create a command to receive a timestamp. This would be useful for understanding collected sensor data.
            There will always be small delays between sending and receiving signals, so timestamping information is crucial. 
            In order to capture timestamps I utilized the Arduino function millis(). By casting the output of that function into a float
            I was able to create a string format as seen below to send data to the user. 
          </p>
          <img src="./images/lab2/millis.PNG">
          <img src="./images/lab2/millisCommand.PNG">
          <h2 style="text-align: center">NOTIFICATION HANDLER</h2> 
          <p>
            Waiting for a string to be sent by the Artemis can be a timely endeavor that slows down the main control loop. 
            To avoid this, I define a notification handler that takes in incoming data into an expanding list.
            Below is the python code I used to define the handler and a video example of the output.
          </p>
          <img src="./images/lab2/nothandler.PNG">
          <iframe width="320" height="560" src="https://www.youtube.com/embed/-Z2Dvaj4rwM" title="Lab 2: Notification Handler" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          <h2 style="text-align: center">GET_TEMP_5s</h2> 
          <p>
            By applying the notification handler, we can now timestamp collected sensor data. To do this, I implement the function
            GET_TEMP_5s. This function collects five timestamped temperature readings one second apart and sends it to my computer. 
            Below is the code I implemented to do that and an example output. 
          </p>
          <img src="./images/lab2/temp5.PNG">
          <img style = "width: 800px"src="./images/lab2/temp5example.PNG">
          <h2 style="text-align: center">GET_TEMP_5s_RAPID</h2> 
          <p>
            The next step in the lab was to send timestamped temperature readings much faster. In the future, sensor readings need 
            to keep up with the fast pace of the robot. Taking that many readings proposes a lot of challenges. 
            For instance, there's still a 151 character limit on the string sent through bluetooth.
            To get around this, we can store temperature and time readings into an array stored locally on the Artemis.
            This means we can send large stores of data in small segments. Below is the code I used to implement this command and 
            example outputs. 
          </p>
          <img src="./images/lab2/temp5rapid.PNG">
          <img style= "width: 800px" src="./images/lab2/temp5examplerapid.PNG">
          <h2 style="text-align: center">TASK 6</h2> 
          <p>
            The final task assigned addresses a problem encountered with the last: how many readings can we take before we run out 
            of memory? If we decided to use the entirety of the Artemis’s RAM to store raw data, we would be able to store 96,000 float data points (384,000 bytes and 4 bytes per float).
            If we divide by two, we get the total number of complete data points we can store (accounting for both Time and Temperature) 
            giving us a final value of 48,000 data points that can be stored in ram before running out of memory. 
            However, this doesn’t account for the string that must be stored to send the data in the first place.
             18 characters are needed to represent one data entry in string format, meaning we can send 8 data points at a time and must 
             reserve 144 bytes to store the string. Recalculating the previous data point limit while accounting for this string doesn’t 
             change the value much (47,982 complete time and temperature data points as opposed to 48,000), but gives a more accurate estimate.
            <br>
            Let’s take a look at 5 seconds of 16-bit values taken at 150 Hz. This will give us 750 values or 1,500 bytes of data. 
            Knowing that 383,856 bytes are available in dynamic memory (accounting for the 144-byte string necessary for communication), 
            I calculate that we can store approximately 256 times the amount of data that was proposed before the Artemis runs out of memory. 
            
          </p>
          <h2 style="text-align: center">CONCLUSION</h2> 
          <p>
            Bluetooth communication is a useful tool that will be utilized in future labs to debug and communicate data. 
            By following the careful and helpful lab instructions, I've learned how to use jupyter lab and Arduino in conjunction
            for this purpose as shown by the completion of the previously assigned tasks. 
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- work details part end -->

<section class="works works-fit">
  <div class="container">
    <h2 class="subtitle">Other Labs</h2>
    <div class="row">
      <div class="col-md-3 col-sm-6">
        <figure class="wow fadeInLeft animated portfolio-item animated" data-wow-duration="300ms" data-wow-delay="0ms"
          style="visibility: visible; animation-duration: 300ms; -webkit-animation-duration: 300ms; animation-delay: 0ms; -webkit-animation-delay: 0ms; animation-name: fadeInLeft; -webkit-animation-name: fadeInLeft;">
          <div class="img-wrapper">
            <img src="images/portfolio/lab1-boardpic.jpeg" class="img-fluid" alt="portfolio items" style="height: 330px">
            <div class="overlay">
              <div class="buttons">
                <a target="_blank" href="single-portfolio.html">Details</a>
              </div>
            </div>
          </div>
          <figcaption>
            <h4>
              <a href="lab1.html">
                LAB 1: Setting Up
              </a>
            </h4>
            <p>
              Setting up the Artemis Board
            </p>
          </figcaption>
        </figure>
      </div>

      <div class="col-md-3 col-sm-6">
        <figure class="wow fadeInLeft animated animated" data-wow-duration="300ms" data-wow-delay="300ms"
          style="visibility: visible; animation-duration: 300ms; -webkit-animation-duration: 300ms; animation-delay: 300ms; -webkit-animation-delay: 300ms; animation-name: fadeInLeft; -webkit-animation-name: fadeInLeft;">
          <div class="img-wrapper">
            <img src="images/lab3cover.png" class="img-fluid" alt="portfolio items" style="height: 330px">
            <div class="overlay">
              <div class="buttons">
                <a target="_blank" href="Lab3.html">Details</a>
              </div>
            </div>
          </div>
          <figcaption>
            <h4>
              <a href="Lab3.html">
                Lab 3: Time of Flight 
              </a>
            </h4>
            <p>
              Implementing and Testing Time of Flight Sensors
            </p>
          </figcaption>
        </figure>
      </div>

      <div class="col-md-3 col-sm-6">
        <figure class="wow fadeInLeft animated animated" data-wow-duration="300ms" data-wow-delay="300ms"
          style="visibility: visible; animation-duration: 300ms; -webkit-animation-duration: 300ms; animation-delay: 300ms; -webkit-animation-delay: 300ms; animation-name: fadeInLeft; -webkit-animation-name: fadeInLeft;">
          <div class="img-wrapper">
            <img src="images/Lab_4_profile.png" class="img-fluid" alt="" style="height: 330px">
            <div class="overlay">
              <div class="buttons">
                <a target="_blank" href="Lab4.html">Details</a>
              </div>
            </div>
          </div>
          <figcaption>
            <h4>
              <a href="Lab4.html">
                Lab 4: The IMU
              </a>
            </h4>
            <p>
              Connecting the artemis to reality.
            </p>
          </figcaption>
        </figure>
      </div>

      <div class="col-md-3 col-sm-6">
        <figure class="wow fadeInLeft animated animated" data-wow-duration="300ms" data-wow-delay="600ms"
          style="visibility: visible; animation-duration: 300ms; -webkit-animation-duration: 300ms; animation-delay: 600ms; -webkit-animation-delay: 600ms; animation-name: fadeInLeft; -webkit-animation-name: fadeInLeft;">
          <div class="img-wrapper">
            <img src="images/lab5prof.png" class="img-fluid" alt="" style="height: 330px">
            <div class="overlay">
              <div class="buttons">
                <a target="_blank" href="Lab5.html">Details</a>
              </div>
            </div>
          </div>
          <figcaption>
            <h4>
              <a href="Lab5.html">
                Lab 5: Motor Control
              </a>
            </h4>
            <p>
              Moving forward among other directions.
            </p>
          </figcaption>
        </figure>
      </div>
    </div>
  </div>
	<!-- Template Javascript Files
	================================================== -->
	<!-- jquery -->
	<script src="plugins/jQurey/jquery.min.js"></script>
	<!-- Form Validation -->
    <script src="plugins/form-validation/jquery.form.js"></script> 
    <script src="plugins/form-validation/jquery.validate.min.js"></script>
	<!-- slick slider -->
	<script src="plugins/slick/slick.min.js"></script>
	<!-- bootstrap js -->
	<script src="plugins/bootstrap/bootstrap.min.js"></script>
	<!-- wow js -->
	<script src="plugins/wow-js/wow.min.js"></script>
	<!-- slider js -->
	<script src="plugins/slider/slider.js"></script>
	<!-- Fancybox -->
	<script src="plugins/facncybox/jquery.fancybox.js"></script>
	<!-- template main js -->
	<script src="js/main.js"></script>
 	</body>
</html>